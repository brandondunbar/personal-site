/* =========================
   Buttons (trim + consistent)
   ========================= */
.btn{
  display:inline-block;
  padding:10px 16px;
  border-radius:var(--radius-sm);
  border:1px solid color-mix(in oklab, var(--accent) 55%, var(--border) 45%);
  background:var(--accent);
  color:#f5f7fa;
  font-weight:650;
  text-decoration:none;
  box-shadow:var(--shadow);
  transition:transform .08s ease, filter .12s ease, box-shadow .12s ease, background-color .12s ease, color .12s ease;
}
.btn:hover{ filter:brightness(0.96); transform:translateY(-1px) }
.btn:active{ transform:translateY(0); box-shadow:var(--shadow-sm) }

.btn--ghost{
  background:transparent;
  color:var(--accent);
  border-color:color-mix(in oklab, var(--accent) 70%, var(--border) 30%);
  box-shadow:none;
}
.btn--ghost:hover{ background:var(--tint-blue); color:var(--text) }

.btn--subtle{
  background:linear-gradient(180deg, color-mix(in oklab, var(--accent) 8%, transparent), transparent);
  color:var(--text);
  border-color:var(--border);
}
.btn--tiny{ padding:6px 10px; font-size:14px; border-radius:var(--radius-xs) }

/* Small badges (single definition) */
.badge{
  display:inline-block;
  padding:.2rem .55rem;
  font-size:.78rem;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--bg-alt);
  white-space:nowrap;
}

/* =========================
   Generic Cards / Article
   ========================= */
.card,
.article{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  box-shadow:var(--shadow);
}
.card{ padding:18px }
.card h3{ margin-top:0; letter-spacing:.15px }
.muted{ color:var(--muted) }

.article{ padding:2rem }
.article h1{ margin-top:0 }
.article pre{
  overflow:auto; background:var(--bg-alt);
  border:1px solid var(--border); border-radius:10px; padding:1rem;
}
.article code{ font-family:var(--mono) }
.post-body code{
  background:var(--tint-blue); padding:.1em .3em; border-radius:6px; border:1px solid var(--border);
}

/* =========================
   Timeline
   ========================= */
.timeline{ counter-reset:step; list-style:none; padding:0; margin:0 }
.timeline li{ position:relative; padding-left:36px; margin:12px 0 }
.timeline li::before{
  counter-increment:step; content:counter(step);
  position:absolute; left:0; top:3px; width:24px; height:24px; border-radius:8px;
  background:linear-gradient(180deg, var(--accent), color-mix(in oklab, var(--accent-600) 60%, var(--accent) 40%));
  color:#f5f7fa; font-weight:700; display:grid; place-items:center;
  box-shadow:0 4px 12px rgba(0,0,0,.25);
}

/* =========================
   Social Rail
   ========================= */
:root { color-scheme: light dark }                   /* prevent icon flash */

.icon-btn{
  display:inline-flex; align-items:center; justify-content:center;
  width:36px; height:36px; border-radius:10px;
  border:1px solid var(--border); background:transparent; color:var(--text);
  cursor:pointer; transition: transform .08s ease, filter .12s ease, box-shadow .12s ease;
}
.icon-btn:hover{ filter:brightness(0.96); transform:translateY(-1px) }
.icon-btn:active{ transform:translateY(0) }

@media (prefers-reduced-motion:no-preference){
  :root{ --_dur:160ms }
  html.theme-transition *{
    transition: background-color var(--_dur), color var(--_dur), border-color var(--_dur), fill var(--_dur);
  }
}

.social-rail{
  position:fixed; left:max(16px, env(safe-area-inset-left)); top:50%; transform:translateY(-50%);
  z-index:100; color:var(--accent); pointer-events:auto;
}
.social-rail ul{
  list-style:none; margin:0; padding:0; display:flex; flex-direction:column; align-items:center; gap:18px; position:relative;
}
.social-rail ul::before,
.social-rail ul::after{
  content:""; display:block; width:1px; height:90px; background:currentColor; opacity:.85; border-radius:1px;
}
.social-rail ul::before{ margin-bottom:10px }
.social-rail ul::after{ margin-top:10px }
.social-rail a{
  display:inline-flex; align-items:center; justify-content:center; width:28px; height:28px; color:inherit; text-decoration:none;
  transition: transform .12s ease, filter .14s ease, opacity .14s ease; opacity:.95;
}
.social-rail svg{ width:24px !important; height:24px !important; stroke-width:1.6; display:block; flex:0 0 auto }
.social-rail a:hover{ transform:translateY(-2px); filter:drop-shadow(0 2px 6px rgba(0,0,0,.25)) }
.social-rail a:focus-visible{ outline:2px solid var(--ring); outline-offset:3px; border-radius:8px }
.social-rail {
  position: fixed;
  left: max(16px, env(safe-area-inset-left));
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  color: var(--social-icon-color);
  pointer-events: auto;
}
@media (max-width:840px){ .social-rail{ display:none } }

/* =========================
   Selected Work (Projects)  <-- Change #work to #projects everywhere below
   ========================= */

.selected-work { padding: 6rem 0; }
.section-header { margin-bottom: 2.5rem; }
.section-header h2 { font-size: 2.5rem; font-weight: 700; margin: 0 0 1rem; }
.section-lede { font-size: 1.125rem; color: var(--muted); max-width: 60ch; margin: 0 auto; line-height: 1.6; }

/* --- Base card appearance --- */
#projects .project-card { /* <-- CORRECTED */
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  box-shadow: var(--shadow);
  overflow: hidden;
  transition: box-shadow .15s ease, transform .12s ease, border-color .15s ease;
}

#projects .project-card:hover { /* <-- CORRECTED */
  transform: translateY(-1px);
  box-shadow: 0 14px 32px rgba(0,0,0,.35);
}

#projects .project-summary { /* <-- CORRECTED */
  list-style: none; padding: 1rem;
  display: flex; align-items: flex-start; justify-content: space-between; gap: .75rem; cursor: pointer;
}
#projects .project-summary::-webkit-details-marker { display: none; }
#projects .project-title { margin: 0 0 .45rem; font-size: 1.05rem; line-height: 1.25; word-break: break-word; hyphens: auto; }
#projects .tech-list { display: flex; flex-wrap: wrap; gap: .4rem; margin: 0; padding: 0; list-style: none; }
#projects .chevron {
  flex-shrink: 0;
  inline-size: 1rem; block-size: 1rem; background: var(--text);
  mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>') center/contain no-repeat;
  transition: transform .18s ease; margin-top: .25rem;
}
#projects .project-card[open] .chevron { transform: rotate(180deg); }
#projects .project-body { display: none; padding: 0 1rem 1rem; border-top: 1px dashed var(--border); }
#projects .project-card[open] .project-body { display: block; }
#projects .project-blurb { margin: .75rem 0; color: var(--muted); line-height: 1.5; }
#projects .highlights { margin: .5rem 0 .5rem 1.25rem; }
#projects .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: .75rem; margin: .5rem 0; }
#projects .gallery img { display: block; width: 100%; height: 140px; object-fit: cover; border-radius: 10px; border: 1px solid var(--border); }
#projects .actions { margin-top: .5rem; display: flex; gap: .5rem; flex-wrap: wrap; }
#projects .actions .is-disabled { opacity: .6; pointer-events: none; }

/* --- GRID LOGIC --- */

/*
 * 1. Resting State: Default to a 3-column grid.
 *    This is our baseline layout for the component.
 */
#projects .project-stack {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1.5rem;
  transition: grid-template-columns 0.4s ease-in-out;
}

/*
 * 2. Viewing State: When a card is open (.has-open is present),
 *    switch to the 2-column master/detail layout.
 *    This only applies on larger screens.
 */
@media (min-width: 1024px) {
  #projects .project-stack.has-open {
    grid-template-columns: 2fr 1fr;
  }

  /* Target only the open card and move it to the left column. */
  #projects .project-stack.has-open .project-card[open] {
    grid-column: 1 / 2;
    grid-row: 1 / 3;
    position: sticky;
    top: 1.5rem;
    border-color: color-mix(in oklab, var(--brand), transparent 60%);
  }

  /* Target only the INACTIVE cards and move them to the right column. */
  #projects .project-stack.has-open .project-card:not([open]) {
    grid-column: 2 / 3;
  }
}

/*
 * 3. Responsive Fallback: On smaller screens, always stack vertically.
 *    This rule has the highest precedence on small viewports.
 */
@media (max-width: 1023.98px) {
  #projects .project-stack {
    grid-template-columns: 1fr;
  }
}

/* =========================
   Bookshelf Carousel (Option B: overlay arrows; .carousel is the scroller)
   ========================= */

/* Rail hosts the viewport + overlay arrows */
.bookshelf-rail{
  position: relative;
  overflow: visible; /* allow overlay arrows to spill if needed */
  /* Prevent rail from intercepting events outside arrows */
  pointer-events: none;
}

/* Scrolling viewport (the ONLY horizontal scroller) */
.bookshelf .carousel{
  position: relative;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  scroll-snap-type: x mandatory;
  /* Hide native scrollbar (keep functionality) */
  scrollbar-width: none;              /* Firefox */
}
.bookshelf .carousel::-webkit-scrollbar{ display: none; } /* WebKit */

/* Track: horizontal row; NOT a scroller */
.carousel__track{
  display:flex;
  flex-wrap:nowrap;
  gap:1rem;
  list-style:none;
  margin:0;
  padding:0 2.5rem; /* reserve space so arrows never cover the covers */
}

/* Slides / cards */
.carousel__slide{ flex:0 0 auto; scroll-snap-align:start; }
.book{ display:block; text-decoration:none; }
.book__figure{ position:relative; margin:0; }
.book__cover{
  display:block; width:144px; height:216px; object-fit:cover;
  border-radius:.5rem; border:1px solid var(--border);
  box-shadow: var(--shadow);
  transition: transform .12s ease, box-shadow .12s ease;
}
.book:hover .book__cover{ transform:translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,.18); }
.book__badge{
  position:absolute; top:.5rem; left:.5rem;
  padding:.25rem .5rem; font-size:.75rem; line-height:1; border-radius:.375rem;
  background:var(--brand); color:var(--bg);
  box-shadow: var(--shadow);
}

/* Overlay arrows (stroke SVGs, no border) */
.carousel-arrow{
  position:absolute;
  top:50%;
  transform:translateY(-50%);
  inline-size:32px; block-size:32px;
  display:grid; place-items:center;
  background:transparent; border:none; padding:0;
  color:var(--muted); z-index:2; cursor:pointer;
  /* No movement on hover to avoid "wiggle" */
  transition: opacity .12s ease, color .12s ease;
  /* Allow clicks; rail has pointer-events:none */
  pointer-events: auto;
}
.carousel-arrow.prev{ left:.25rem; }
.carousel-arrow.next{ right:.25rem; }
.carousel-arrow:hover{ color:var(--text); }
.carousel-arrow:focus{ outline:none; }
.carousel-arrow:focus-visible{
  box-shadow:0 0 0 3px color-mix(in srgb, var(--brand) 40%, transparent);
  border-radius:.5rem;
}
.carousel-arrow.is-disabled{ opacity:0; pointer-events:none; }

/* Motion preference */
@media (prefers-reduced-motion: reduce){
  .book__cover{ transition:none; }
}

/* Theme toggle button (leave as-is) */
#theme-toggle {
  border-color: transparent;
  background: transparent;
}

